<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eSIM Podaci</title>
</head>
<body>
    <h1>Podaci o eSIM Kartici</h1>

    <label for="iccidInput">Unesite ICCID kartice:</label>
    <input type="text" id="iccidInput" placeholder="Unesite ICCID">
    <button onclick="fetchESimData()">Pretraži</button>

    <div id="result"></div>

    <script>
        function fetchESimData() {
    const idInput = document.getElementById('idInput').value.trim();
    if (!idInput) {
        alert('Molimo unesite ID kartice.');
        return;
    }

    const url = `https://esim.sm/api/reseller/v1/esim`;
    const myHeaders = new Headers();

    const requestOptions = {
        method: 'GET',
        headers: myHeaders,
        redirect: 'follow'
    };

    fetch(url, requestOptions)
        .then(response => response.json())
        .then(result => {
            const data = result.data;
            const foundCard = data.find(card => card.id === parseInt(idInput));

            const resultDiv = document.getElementById('result');
            if (foundCard) {
                resultDiv.innerHTML = `
                    <h2>Podaci za ID: ${foundCard.id}</h2>
                    <p>Status: ${foundCard.statusLabel}</p>
                    <p>Plan: ${foundCard.plan.name}</p>
                    <p>Preostalo MB: ${foundCard.mbTotal - foundCard.mbUsed} MB</p>
                    <p>Datum isteka: ${foundCard.expirationTimestamp}</p>
                    <p>Cena: ${foundCard.plan.price} ${foundCard.plan.currency}</p>
                `;
            } else {
                resultDiv.innerHTML = `<p>eSIM kartica sa unetim ID-om nije pronađena.</p>`;
            }
        })
        .catch(error => {
            console.log('Greška pri preuzimanju podataka:', error);
            document.getElementById('result').innerHTML = '<p>Došlo je do greške prilikom preuzimanja podataka.</p>';
        });
}
    </script>
</body>
</html>